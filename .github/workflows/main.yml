name: 洛谷自动签到

on:
  schedule:
    # 每天 UTC+8 时间 00:01 运行 (UTC 16:01)
    - cron: '1 16 * * *'
  workflow_dispatch: # 允许手动触发
  push:
    branches: [ main ]

jobs:
  signin:
    runs-on: ubuntu-latest
    
    steps:
    - name: 检出代码
      uses: actions/checkout@v4
      
    - name: 设置 Node.js
      uses: actions/setup-node@v4
      with:
        node-version: '18'
        cache: 'npm'
        
    - name: 安装依赖
      run: npm ci
      
    - name: 执行洛谷签到
      env:
        LUOGU_COOKIE: ${{ secrets.LUOGU_COOKIE }}
      run: node scripts/luogu-signin.js
